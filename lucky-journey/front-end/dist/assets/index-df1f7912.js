import{r as k,u as W,j as X,k as N,l as Y,o as Z,m as ee,a as l,b as c,c as d,w as o,n as te,p as q,f as t,g as s,i as b,q as oe,e as le,t as ae,s as ne,v as ue}from"./index-0c93d47c.js";const ie={__name:"index",setup(se){const V=k(),r=W(),g=X(),a=k({}),m=k(!1),i=k(),p=k(-1),v=k({show:!1,text:""}),_=N(()=>a.value?r.$state.info.id==a.value.id:!1),h=N(()=>{if(!a.value)return w(),"/logo.png";if(i.value&&i.value.files&&i.value.files[0]){var u=window.URL||window.webkitURL;return u.createObjectURL(i.value.files[0])}return a.value==null||a.value.avatar==null?"/logo.png":te(a.value.avatar)}),R=()=>{i.value.files[0]&&ue(i.value.files[0],{next:u=>{p.value=u.total.percent},error:()=>{p.value=-1,v.value={text:"上传失败",show:!0,color:"error"}},complete:(u,e)=>{if(p.value=-1,!e.state){v.value={text:e.message,show:!0};return}a.value.avatar=e.data,v.value={text:"上传完成",show:!0,color:"success"}}})},w=()=>{g.query&&g.query.lookId?r.$patch({lookId:g.query.lookId}):r.$patch({lookId:r.$state.info.id}),q(r.$state.lookId).then(({data:u})=>{u.state&&(a.value=u.data)})},j=()=>{ne(a.value).then(({data:u})=>{v.value={text:u.message,show:!0,color:u.state?"success":"error"},u.state&&(m.value=!1,q(a.value.id).then(({data:e})=>{e.state&&r.$patch({info:e.data})}))})};return Y(()=>g.query,()=>{w()},{immediate:!0}),Z(()=>{r.$state.token||ee.push({path:"/"}),r.$patch({lookId:g.query.lookId||r.info.id}),w()}),(u,e)=>{const F=l("v-avatar"),S=l("v-list-item"),B=l("v-list"),$=l("v-img"),f=l("v-tab"),U=l("v-spacer"),x=l("v-btn"),L=l("v-tabs"),y=l("v-card"),D=l("router-view"),I=l("v-divider"),G=l("v-icon"),z=l("v-progress-circular"),A=l("v-overlay"),M=l("v-hover"),C=l("v-text-field"),O=l("v-switch"),P=l("v-form"),T=l("v-card-text"),E=l("v-card-actions"),H=l("v-dialog"),J=l("v-snackbar"),K=l("v-container");return c(),d(K,{fluid:!0,style:{height:"500px"}},{default:o(()=>[t(y,null,{default:o(()=>[t($,{height:220,"aspect-ratio":"16/9",cover:"",src:"https://cdn.vuetifyjs.com/images/parallax/material.jpg"},{default:o(()=>[t(B,{style:{position:"absolute",left:"0",bottom:"0",width:"100%","background-color":"rgba(1,1,1,0.5)",color:"white"}},{default:o(()=>[t(S,{title:a.value.nickName,subtitle:a.value.description},{prepend:o(()=>[t(F,{image:h.value,size:"50"},null,8,["image"])]),_:1},8,["title","subtitle"])]),_:1})]),_:1}),t(L,{modelValue:V.value,"onUpdate:modelValue":e[1]||(e[1]=n=>V.value=n),color:"#7bbfea"},{default:o(()=>[t(f,{value:"aa",to:`/user/home${_.value?"":"?lookId="+a.value.id}`},{default:o(()=>[s("主页")]),_:1},8,["to"]),_.value?(c(),d(f,{key:0,value:"one",to:"/user/video"},{default:o(()=>[s("创作中心")]),_:1})):b("",!0),_.value?(c(),d(f,{key:1,value:"two",to:"/user/favorites"},{default:o(()=>[s("收藏夹")]),_:1})):b("",!0),_.value?(c(),d(f,{key:2,value:"3",to:"/user/history"},{default:o(()=>[s("历史记录")]),_:1})):b("",!0),_.value?(c(),d(f,{key:3,value:"two3",to:"/user/classify"},{default:o(()=>[s("订阅分类")]),_:1})):b("",!0),t(f,{value:"4",to:`/user/like${_.value?"":"?lookId="+a.value.id}`},{default:o(()=>[s("关注/粉丝")]),_:1},8,["to"]),t(U),_.value?(c(),d(x,{key:4,class:"ma-2",variant:"text",onClick:e[0]||(e[0]=n=>m.value=!m.value)},{default:o(()=>[s("编辑信息")]),_:1})):b("",!0)]),_:1},8,["modelValue"])]),_:1}),t(D,{class:"mt-2"}),t(H,{modelValue:m.value,"onUpdate:modelValue":e[8]||(e[8]=n=>m.value=n),"max-width":"400"},{default:o(()=>[t(y,{title:"编辑用户信息"},{default:o(()=>[t(I),t(T,null,{default:o(()=>[t(P,null,{default:o(()=>[t(M,null,{default:o(({isHovering:n,props:Q})=>[t(y,oe(Q,{class:"mb-2 mx-auto",height:"70px",width:"70px",rounded:10,onClick:e[2]||(e[2]=re=>i.value.click())}),{default:o(()=>[t($,{rounded:10,src:h.value},null,8,["src"]),t(A,{"model-value":n==!0||p.value>-1,contained:"",scrim:"black",class:"align-center justify-center"},{default:o(()=>[p.value==-1?(c(),d(G,{key:0},{default:o(()=>[s("mdi-upload")]),_:1})):(c(),d(z,{key:1,"model-value":p.value},null,8,["model-value"]))]),_:2},1032,["model-value"])]),_:2},1040)]),_:1}),le("input",{hidden:"",onChange:R,ref_key:"avatarFileRef",ref:i,type:"file",accept:"image/*"},null,544),t(C,{modelValue:a.value.nickName,"onUpdate:modelValue":e[3]||(e[3]=n=>a.value.nickName=n),label:"昵称",placeholder:"请输入昵称"},null,8,["modelValue"]),t(C,{modelValue:a.value.description,"onUpdate:modelValue":e[4]||(e[4]=n=>a.value.description=n),label:"描述",placeholder:"请输入描述"},null,8,["modelValue"]),t(O,{modelValue:a.value.sex,"onUpdate:modelValue":e[5]||(e[5]=n=>a.value.sex=n),label:a.value.sex?"男生":"女生",inset:"",color:"blue"},null,8,["modelValue","label"])]),_:1})]),_:1}),t(I),t(E,null,{default:o(()=>[t(x,{text:"取消",color:"warning",onClick:e[6]||(e[6]=n=>m.value=!1)}),t(U),t(x,{text:"保存",color:"success",onClick:e[7]||(e[7]=n=>j())})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(J,{modelValue:v.value.show,"onUpdate:modelValue":e[10]||(e[10]=n=>v.value.show=n),color:v.value.color},{actions:o(()=>[t(x,{color:"blue",variant:"text",onClick:e[9]||(e[9]=n=>v.value.show=!1)},{default:o(()=>[s(" 了解 ")]),_:1})]),default:o(()=>[s(ae(v.value.text)+" ",1)]),_:1},8,["modelValue","color"])]),_:1})}}};export{ie as default};
